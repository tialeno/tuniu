define('indexCatalogData',function(){return window.indexCatalogData});define('tn_catalog/index',['indexCatalogData','jquery','underscore','config/Base','component/tour','component/package','component/flight','component/hotel','component/ticket','component/cruise','component/local','component/sections','component/tabs'],function(indexCatalogData,$,_,BaseConfig,TourFactory,PackageFactory,FlightFactory,HotelFactory,TicketFactory,CruiseFactory,LocalFactory,SectionFactory,TabFactory){var exports={};exports.init=function(){var tabs,sections,defaultWrap,defaultModule='tour',searchType=defaultModule,Map={tour:{wrap:'J_CatalogSeconds',factory:TourFactory,instance:null,visible:false,parentWrap:''},package:{wrap:'J_SearchPackage',factory:PackageFactory,instance:null,visible:false,parentWrap:'J_CatalogRegular'},flight:{wrap:'J_SearchFlight',factory:FlightFactory,instance:null,visible:false,parentWrap:'J_CatalogRegular'},hotel:{wrap:'J_SearchHotel',factory:HotelFactory,instance:null,visible:false,parentWrap:'J_CatalogRegular'},ticket:{wrap:'J_SearchTicket',factory:TicketFactory,instance:null,visible:false,parentWrap:'J_CatalogRegular'},cruise:{wrap:'J_SearchCruise',factory:CruiseFactory,instance:null,visible:false,parentWrap:'J_CatalogRegular'},local:{wrap:'J_SearchLocal',factory:LocalFactory,instance:null,visible:false,parentWrap:'J_CatalogRegular'}},loading=false,searching=false;tabs=TabFactory($('.J_SearchTabs'));tabs.on('changed',showModule);showModule(defaultModule);function showModule(showType){var searchModule=Map[showType];if(loading||searching||!searchModule||searchModule.visible){return;}
_.each(Map,function(searchModule,moduleType){var instance;if(searchModule){if(moduleType==showType){if(!searchModule.instance){instance=searchModule.instance=searchModule.factory($('.'+searchModule.wrap),indexCatalogData.defaultCity);instance.on('submit',function(){searchType=showType;});}
if(searchModule.parentWrap!==''){$('.'+searchModule.parentWrap).show();defaultWrap=searchModule.parentWrap;}else{$('.'+defaultWrap).hide();defaultWrap="";}
if($.browser.msie&&parseInt($.browser.version)==7){$(searchModule.instance.element).addClass('repairIE7');}
searchModule.instance.show();searchModule.visible=true;}else{if(searchModule.visible){searchModule.instance.hide();searchModule.visible=false;if($.browser.msie&&parseInt($.browser.version)==7){if($(searchModule.instance.element).hasClass('repairIE7')){$(searchModule.instance.element).removeClass('repairIE7');}}}}}});}
sections=SectionFactory($('.J_CatalogSeconds'));$(".tn_catalog,.autocomplete-suggestions,.cp_drop,.dp_panel").live("click",function(event){var e=event||window.event;if(e.stopPropagation){e.stopPropagation();}else{e.cancelBubble=true;}});$(".tn_catalog").live("click",function(){$('.autocomplete-suggestions,.search_ctrl_select_options').hide();})
$("body").live("click",function(event){showModule(defaultModule);TabFactory($('.J_SearchTabs'));$('.search_ctrl_select_options').hide();});$(".J_catalogClose").live("click",function(event){$.each(Map,function(sectionType,section){if(section.instance){section.instance.hide();}});showModule(defaultModule);TabFactory($('.J_SearchTabs'));});$('.rankPagination').on('click','span',function(e){var $self=$(this);var index=$self.parent().find('span').index(this);var tabContent=$self.parent().nextAll('.rankPages');$self.addClass('active').siblings().removeClass('active');tabContent.css({display:'none'}).eq(index).css({display:'block'});});}
return exports;});